Object subclass: #CentroTrasplantes	instanceVariableNames: 'listaDonantes listaPacientes nombreCentro resultados evaluadorCompatibilidad asociaciones fechasIngreso'	classVariableNames: ''	package: 'TrabajoPractico-1'!!CentroTrasplantes methodsFor: 'accessing' stamp: 'Franklyn 10/26/2025 20:15'!evaluadorCompatibilidad: unEvaluadorCompatibilidad	evaluadorCompatibilidad := unEvaluadorCompatibilidad.	self inicializarResultados.! !!CentroTrasplantes methodsFor: 'initialization' stamp: 'Franklyn 10/26/2025 18:56'!setPacientes: pacientes	listaPacientes := pacientes! !!CentroTrasplantes methodsFor: 'initialization' stamp: 'Franklyn 10/26/2025 18:54'!setDonantes: anObject	listaDonantes := anObject! !!CentroTrasplantes methodsFor: 'initialization' stamp: 'Franklyn 10/26/2025 20:16'!inicializarCentro: unNombre	nombreCentro := unNombre.	listaPacientes := Dictionary new.	listaDonantes := Dictionary new.	asociaciones := Dictionary new.	self inicializarResultados.	fechasIngreso := Dictionary new.! !!CentroTrasplantes methodsFor: 'initialization' stamp: 'Franklyn 10/26/2025 18:56'!setNombreDelCentro: unNombre	nombreCentro := unNombre.! !!CentroTrasplantes methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 20:19'!guardaRegistros: prefijoNombreArchivo	| fechaActual |	fechaActual := Date today.	self generaArchivoPacientes: prefijoNombreArchivo fechaActual: fechaActual.	self generaArchivoDonantes: prefijoNombreArchivo.	self generaArchivoCompatibilidades: prefijoNombreArchivo.! !!CentroTrasplantes methodsFor: 'as yet unclassified' stamp: 'franklyn 11/6/2025 22:31'!guardaBaseDeDatosProlog	| archivo fechaActual |	archivo := (nombreCentro, '.pl') asFileReference writeStream.	fechaActual := Date today.		archivo nextPutAll: '% --- Base de Datos de Pacientes ---'; cr.		listaPacientes valuesDo: [:paciente |		| meses |		meses := self mesesEnLista: (fechasIngreso at: paciente getDNI) hasta: fechaActual.		archivo			nextPutAll: 'paciente(dni(';			nextPutAll: paciente getDNI asString;			nextPutAll: '), nombre("';			nextPutAll: paciente getNombre;			nextPutAll: '", "';			nextPutAll: paciente getApellido;			nextPutAll: '"), tiempo_espera(';			nextPutAll: meses asString;			nextPutAll: ')).';			cr.	].	archivo cr; nextPutAll: '% --- Base de Datos de Donantes Registrados ---'; cr.		asociaciones keysAndValuesDo: [:dniPaciente :dniDonante |		| donante |		donante := listaDonantes at: dniDonante.		archivo			nextPutAll: 'donante(dni(';			nextPutAll: dniDonante asString;			nextPutAll: '), nombre("';			nextPutAll: donante getNombre;			nextPutAll: '", "';			nextPutAll: donante getApellido;			nextPutAll: '"), dni_paciente(';			nextPutAll: dniPaciente asString;			nextPutAll: ')).';			cr.	].	archivo cr; nextPutAll: '% --- Base de Datos de Compatibilidades (>= 50%) ---'; cr.		resultados do: [:resultado |		resultado compatible ifTrue: [			archivo				nextPutAll: 'compatibilidad(';				nextPutAll: resultado getDonante getDNI asString;				nextPutAll: ', ';				nextPutAll: resultado getPaciente getDNI asString;				nextPutAll: ', ';				nextPutAll: resultado porcentajeCompatibilidad asString;				nextPutAll: ').';				cr.		].	].	archivo close.! !!CentroTrasplantes methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 20:19'!mesesEnLista: fechaIngreso hasta: fechaActual	^ ((fechaActual year - fechaIngreso year) * 12) + (fechaActual monthIndex - fechaIngreso monthIndex).! !!CentroTrasplantes methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 20:16'!getEvaluadorCompatibilidad	^evaluadorCompatibilidad! !!CentroTrasplantes methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 20:18'!generaArchivoCompatibilidades: prefijo	| archivo |	archivo := (prefijo, '_compatibilidades.csv') asFileReference writeStream.	archivo nextPutAll: 'dni_paciente,dni_donante,porcentaje_compatibilidad'; cr.	resultados do: [:resultado |		resultado compatible ifTrue: [			archivo				nextPutAll: resultado getPaciente getDNI asString; nextPut: $,;				nextPutAll: resultado getDonante getDNI asString; nextPut: $,;				nextPutAll: resultado porcentajeCompatibilidad asString; cr.		].	].	archivo close.! !!CentroTrasplantes methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 20:19'!generaArchivoDonantes: prefijo	| archivo |	archivo := (prefijo, '_donantes.csv') asFileReference writeStream.	archivo nextPutAll: 'dni_donante,nombre_donante,apellido_donante,dni_paciente'; cr.	asociaciones keysAndValuesDo: [:dniPaciente :dniDonante |		| donante |		donante := listaDonantes at: dniDonante.		archivo			nextPutAll: dniDonante asString; nextPut: $,;			nextPutAll: donante getNombre ; nextPut: $,;			nextPutAll: donante getApellido ; nextPut: $,;			nextPutAll: dniPaciente asString; cr.	].	archivo close.! !!CentroTrasplantes methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 20:18'!calculaCompatibilidadesGeneral	| resultadosCalculados |	resultadosCalculados := OrderedCollection new.	listaPacientes valuesDo: [ :paciente |		listaDonantes valuesDo: [ :donante |			| resultado |			resultado := self compatibilidad: paciente con: donante.			resultadosCalculados add: resultado.		].	].	^resultadosCalculados.! !!CentroTrasplantes methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 18:55'!getListaPacientes	^ listaPacientes! !!CentroTrasplantes methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 20:18'!calculaCompatibilidadesRegistrados	| resultadosCalculados |	resultadosCalculados := OrderedCollection new.	asociaciones keysAndValuesDo: [ :dniPaciente :dniDonante |		| paciente donante resultado |		paciente := listaPacientes at: dniPaciente.		donante := listaDonantes at: dniDonante.		resultado := self compatibilidad: paciente con: donante.		resultadosCalculados add: resultado.	].	^ resultadosCalculados.! !!CentroTrasplantes methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 20:18'!compatibilidad: unPaciente con: unDonante	| resultado |	evaluadorCompatibilidad ifNil: [ self error: 'No hay un evaluador de compatibilidad' ].	resultado := evaluadorCompatibilidad compatibilidadPaciente: unPaciente con: unDonante.	resultados add: resultado.	^resultado.! !!CentroTrasplantes methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 18:57'!getNombreCentro 	^nombreCentro.! !!CentroTrasplantes methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 20:17'!agregaPaciente: unaPersona	self agregaPaciente: unaPersona fechaIngreso: Date today.! !!CentroTrasplantes methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 18:56'!nombreDelCentro: unNombre	self setNombreDelCentro: unNombre.! !!CentroTrasplantes methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 20:17'!inicializarResultados	resultados := OrderedCollection new.! !!CentroTrasplantes methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 20:16'!getPacientes	^listaPacientes! !!CentroTrasplantes methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 18:57'!getDonantes	^listaDonantes! !!CentroTrasplantes methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 20:17'!agregaPaciente: unaPersona fechaIngreso: unaFecha	(listaPacientes includesKey: unaPersona getDNI) ifTrue: [ self error: 'Ya existe un paciente con ese DNI.' ].	(listaDonantes includesKey: unaPersona getDNI) ifTrue: [ self error: 'Ya existe un donante con ese DNI.' ].	listaPacientes at: unaPersona getDNI put: unaPersona.	fechasIngreso at: unaPersona getDNI put: unaFecha.! !!CentroTrasplantes methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 20:17'!asociaPaciente:  unaPersona conDonante: otraPersona	(listaPacientes includesKey: unaPersona getDNI) ifFalse: [ self error: 'El paciente no está registrado.' ].	(listaDonantes includesKey: otraPersona getDNI) ifFalse: [ self error: 'El donante no está registrado.' ].	asociaciones at: unaPersona getDNI put: otraPersona getDNI.! !!CentroTrasplantes methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 20:19'!generaArchivoPacientes: prefijo fechaActual: fechaActual	| archivo |	archivo := (prefijo, '_pacientes.csv') asFileReference writeStream.	archivo nextPutAll: 'dni,nombre,apellido,meses_en_lista'; cr.	listaPacientes valuesDo: [:paciente |		| meses |		meses := self mesesEnLista: (fechasIngreso at: paciente getDNI) hasta: fechaActual.		archivo			nextPutAll: paciente getDNI asString; nextPut: $,;			nextPutAll: paciente getNombre; nextPut: $,;			nextPutAll: paciente getApellido; nextPut: $,;			nextPutAll: meses asString; cr.	].	archivo close.! !!CentroTrasplantes methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 20:17'!agregaDonante: unaPersona	(listaPacientes includesKey: unaPersona getDNI) ifTrue: [ self error: 'Ya existe un paciente con ese DNI.' ].	(listaDonantes includesKey: unaPersona getDNI) ifTrue: [ self error: 'Ya existe un donante con ese DNI.' ].	listaDonantes at: unaPersona getDNI put: unaPersona.! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!CentroTrasplantes class	instanceVariableNames: ''!!CentroTrasplantes class methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 20:19'!conNombre: nombreDelCentro	| instancia |	instancia := self new.	instancia inicializarCentro: nombreDelCentro.	^instancia.! !Object subclass: #Criterio	instanceVariableNames: ''	classVariableNames: ''	package: 'TrabajoPractico-1'!!Criterio methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/5/2025 08:50'!estudioDe: laClase en: unaPersona		^unaPersona estudioDeTipo: laClase.! !!Criterio methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 18:59'!evaluaCompatibilidad: unPaciente con: unDonante	self subclassResponsibility.! !!Criterio methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 18:59'!estudiosFaltantes:  unPaciente con: unDonante	 self subclassResponsibility. ! !Criterio subclass: #CriterioDeseable	instanceVariableNames: 'ponderacion'	classVariableNames: ''	package: 'TrabajoPractico-1'!!CriterioDeseable methodsFor: 'initialization' stamp: 'Franklyn 10/26/2025 19:05'!setPonderacion: unaPonderacion	ponderacion := unaPonderacion.! !!CriterioDeseable methodsFor: 'accessing' stamp: 'Franklyn 10/5/2025 08:56'!ponderacion: unaPonderacion	ponderacion := unaPonderacion.! !!CriterioDeseable methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/4/2025 16:54'!getPonderacion	^ponderacion! !CriterioDeseable subclass: #CriterioEdad	instanceVariableNames: ''	classVariableNames: ''	package: 'TrabajoPractico-1'!!CriterioEdad methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 20:38'!estudiosFaltantes: unPaciente con: unDonante	| faltantes |    faltantes := OrderedCollection new.   	(unPaciente edad  isNil) ifTrue: [ faltantes add: 'Edad paciente' ].	(unDonante edad isNil) ifTrue: [ faltantes add: 'Edad donante' ].    ^ faltantes! !!CriterioEdad methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 20:31'!evaluaCompatibilidad: unPaciente con: unDonante	| diferencia porcentaje edadD edadP |		edadD := unDonante edad.	edadP := unPaciente edad.		diferencia := (edadD - edadP) abs.		porcentaje := ((0 max: (1 - (diferencia / 30))) * 100).		^porcentaje max: 0.! !!CriterioEdad methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 19:01'!inicializarEdad	super ponderacion: 5.! !CriterioDeseable subclass: #CriterioHLA	instanceVariableNames: ''	classVariableNames: ''	package: 'TrabajoPractico-1'!!CriterioHLA methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 20:32'!evaluaCompatibilidad: unPaciente con: unDonante	| matches hlaP hlaD |	matches := 0.	hlaP := unPaciente estudioDeTipo: EstudioTipificacionHLA.	hlaD := unDonante estudioDeTipo: EstudioTipificacionHLA.		(hlaP isNil or: [ hlaD isNil ]) ifTrue: [ ^ 0.0 ].		"Locus A"	hlaD getA do: [ :aleloD |		(hlaP getA includes: aleloD) ifTrue: [ matches := matches + 1 ].	].		"Locus B"	hlaD getB do: [ :aleloD |		(hlaP getB includes: aleloD) ifTrue: [ matches := matches + 1 ].	].		"Locus DR"	hlaD getDR do: [ :aleloD |		(hlaP getDR includes: aleloD) ifTrue: [ matches := matches + 1 ].	].		^ (matches / 6.0) * 100.0.! !!CriterioHLA methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 20:32'!estudiosFaltantes: unPaciente con: unDonante	| faltantes |	faltantes := OrderedCollection new.	(unPaciente estudioDeTipo: EstudioTipificacionHLA) ifNil: [ faltantes add: 'EstudioTipificacionHLA del paciente' ].	(unDonante estudioDeTipo: EstudioTipificacionHLA) ifNil: [ faltantes add: 'EstudioTipificacionHLA del donante' ].	^ faltantes! !!CriterioHLA methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 19:05'!inicializarHLA	super setPonderacion: 45.! !Criterio subclass: #CriterioObligatorio	instanceVariableNames: ''	classVariableNames: ''	package: 'TrabajoPractico-1'!CriterioObligatorio subclass: #CriterioABO	instanceVariableNames: ''	classVariableNames: ''	package: 'TrabajoPractico-1'!!CriterioABO methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 20:29'!evaluaCompatibilidad: unPaciente con: unDonante    | grupoD grupoP |    grupoD := unDonante estudioDeTipo: AnalisisDeSangre.    grupoP := unPaciente estudioDeTipo: AnalisisDeSangre.		grupoD getGrupoSanguineo = #O ifTrue: [ ^#apto ].	grupoD getGrupoSanguineo = #A ifTrue: [		^(grupoP getGrupoSanguineo = #A or: [ grupoP getGrupoSanguineo = #AB ])			ifTrue: [ #apto ]			ifFalse: [ #noApto ].	].	grupoD getGrupoSanguineo = #B ifTrue: [		^(grupoP getGrupoSanguineo = #B or: [ grupoP getGrupoSanguineo = #AB ])			ifTrue: [ #apto ]			ifFalse: [ #noApto ].	].	grupoD getGrupoSanguineo = #AB ifTrue: [		^(grupoP getGrupoSanguineo = #AB)			ifTrue: [ #apto ]			ifFalse: [ #noApto ].	].	^#noApto! !!CriterioABO methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 20:29'!estudiosFaltantes: unPaciente con: unDonante	| faltantes |	faltantes := OrderedCollection new.	(unPaciente estudioDeTipo: AnalisisDeSangre) ifNil: [ faltantes add: 'AnalisisDeSangre del paciente' ].	(unDonante estudioDeTipo: AnalisisDeSangre) ifNil: [ faltantes add: 'AnalisisDeSangre del donante' ].	^ faltantes! !CriterioObligatorio subclass: #CriterioAptitudDonante	instanceVariableNames: ''	classVariableNames: ''	package: 'TrabajoPractico-1'!!CriterioAptitudDonante methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/5/2025 12:29'!evaluaCompatibilidad: unPaciente con: unDonante    | e |    e := unDonante estudioDelTipo: EstudioAptitudGeneral.    e ifNil: [self error: 'Falta aptitud general del donante'].    ^ e getResultado! !!CriterioAptitudDonante methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/5/2025 12:29'!estudiosFaltantes: unPaciente con: unDonante    ^ (unDonante estudioDelTipo: EstudioAptitudGeneral)        ifNil: [OrderedCollection with: 'EstudioAptitudGeneral - donante']        ifNotNil: [OrderedCollection new]! !CriterioObligatorio subclass: #CriterioCrossmatch	instanceVariableNames: ''	classVariableNames: ''	package: 'TrabajoPractico-1'!!CriterioCrossmatch methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 20:29'!evaluaCompatibilidad: unPaciente con: unDonante	| estudioCrossmatch |	estudioCrossmatch := unPaciente estudioDeTipo: EstudioCrossmatch.		estudioCrossmatch getCrossmatch = #positivo		ifTrue: [ ^#noApto ]		ifFalse: [ ^#apto ].! !!CriterioCrossmatch methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 20:29'!estudiosFaltantes: unPaciente con: unDonante	| faltantes |	faltantes := OrderedCollection new.	(unPaciente estudioDeTipo: EstudioCrossmatch) ifNil: [ faltantes add: 'EstudioCrossmatch (paciente-donante)' ].	^ faltantes! !CriterioObligatorio subclass: #CriterioEstadoClinico	instanceVariableNames: ''	classVariableNames: ''	package: 'TrabajoPractico-1'!!CriterioEstadoClinico methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 20:30'!evaluaCompatibilidad: unPaciente con: unDonante	| estudio |	estudio := unDonante estudioDeTipo: EstudioAptitudGeneral.	^ estudio getAptitudGeneral.! !!CriterioEstadoClinico methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 20:30'!estudiosFaltantes: unPaciente con: unDonante	| faltantes |	faltantes := OrderedCollection new.	(unDonante estudioDeTipo: EstudioAptitudGeneral) ifNil: [ faltantes add: 'EstudioAptitudGeneral del donante' ].	^ faltantes! !CriterioDeseable subclass: #CriterioPRA	instanceVariableNames: ''	classVariableNames: ''	package: 'TrabajoPractico-1'!!CriterioPRA methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 19:17'!inicializarPRA	super ponderacion: 45.! !!CriterioPRA methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 20:33'!evaluaCompatibilidad: unPaciente con: unDonante	| suma porcentaje praP hlaD todosAlelosD |	suma := 0.		praP := unPaciente estudioDeTipo: EstudioAnticuerposPRA.	hlaD := unDonante estudioDeTipo: EstudioTipificacionHLA.		(praP isNil or: [ hlaD isNil ]) ifTrue: [ ^ 0.0 ].	todosAlelosD := hlaD getA, hlaD getB, hlaD getDR.		praP getAnticuerposPra keysAndValuesDo: [ :alelo :reactividad |		(todosAlelosD includes: alelo) ifTrue: [			suma := suma + reactividad.		].	].		"porcentaje = max(0, 100 - suma)"	porcentaje := 0 max: (100 - suma).	^ porcentaje.! !!CriterioPRA methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 20:33'!estudiosFaltantes: unPaciente con: unDonante	| faltantes |	faltantes := OrderedCollection new.	(unPaciente estudioDeTipo: EstudioAnticuerposPRA) ifNil: [ faltantes add: 'EstudioAnticuerposPRA del paciente' ].	(unDonante estudioDeTipo: EstudioTipificacionHLA) ifNil: [ faltantes add: 'EstudioTipificacionHLA del donante' ].	^ faltantes! !CriterioObligatorio subclass: #CriterioSerologias	instanceVariableNames: ''	classVariableNames: ''	package: 'TrabajoPractico-1'!!CriterioSerologias methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 20:30'!evaluaCompatibilidad: unPaciente con: unDonante	| serP serD |	serP := unPaciente estudioDeTipo: EstudioSerologicoCompleto.	serD := unDonante estudioDeTipo: EstudioSerologicoCompleto.		(serP getSerologicoCompleto = #apto and: [ serD getSerologicoCompleto = #apto ])		ifTrue: [ ^#apto ]		ifFalse: [ ^#noApto ].! !!CriterioSerologias methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 20:30'!estudiosFaltantes: unPaciente con: unDonante	| faltan |	faltan := OrderedCollection new.	(unPaciente estudioDeTipo: EstudioSerologicoCompleto) ifNil: [faltan add: 'EstudioSerologicoCompleto del paciente'].	(unDonante estudioDeTipo: EstudioSerologicoCompleto) ifNil: [faltan add: 'EstudioSerologicoCompleto del donante'].	^ faltan.! !CriterioDeseable subclass: #CriterioTamanoCorporal	instanceVariableNames: ''	classVariableNames: ''	package: 'TrabajoPractico-1'!!CriterioTamanoCorporal methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 19:13'!inicializarTamanoCorporal	super ponderacion: 5.! !!CriterioTamanoCorporal methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 20:33'!evaluaCompatibilidad: unPaciente con: unDonante	| diferencia imcP imcD porcentaje |		unPaciente getPeso ifNil: [ ^0.0 ].	unPaciente getEstatura ifNil: [ ^0.0 ].	unDonante getPeso ifNil: [ ^0.0 ].	unDonante getEstatura ifNil: [ ^0.0 ].	imcP := unPaciente getPeso / (unPaciente getEstatura squared).	imcD := unDonante getPeso / (unDonante getEstatura squared).		diferencia := (imcD - imcP) abs.		porcentaje := ((0 max: (1 - (diferencia / 10))) * 100).		^porcentaje max: 0.! !!CriterioTamanoCorporal methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 20:34'!estudiosFaltantes: unPaciente con: unDonante	| faltantes |	faltantes := OrderedCollection new.	(unPaciente getPeso isNil or: [unPaciente getEstatura isNil]) ifTrue: [ faltantes add: 'Peso/Estatura del paciente' ].	(unDonante getPeso isNil or: [unDonante getEstatura isNil]) ifTrue: [ faltantes add: 'Peso/Estatura del donante' ].	^ faltantes! !Object subclass: #EstudioClinico	instanceVariableNames: ''	classVariableNames: ''	package: 'TrabajoPractico-1'!"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!EstudioClinico class	instanceVariableNames: 'grupoSanguineo crossmatch aptitudGeneral serologicoCompleto tipificacionHLA anticuerposPra'!EstudioClinico subclass: #AnalisisDeSangre	instanceVariableNames: 'grupoSanguineo'	classVariableNames: ''	package: 'TrabajoPractico-1'!!AnalisisDeSangre methodsFor: 'initialization' stamp: 'franklyn 11/6/2025 23:13'!setGrupoSanguineo: unGrupo	grupoSanguineo := unGrupo.! !!AnalisisDeSangre methodsFor: 'as yet unclassified' stamp: 'franklyn 11/6/2025 23:13'!getGrupoSanguineo	^grupoSanguineo! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!AnalisisDeSangre class	instanceVariableNames: ''!!AnalisisDeSangre class methodsFor: 'as yet unclassified' stamp: 'franklyn 11/6/2025 23:13'!conGrupoSanguineo: unGrupoSanguineo	^ self new setGrupoSanguineo: unGrupoSanguineo; yourself.! !EstudioClinico subclass: #EstudioAnticuerposPRA	instanceVariableNames: 'anticuerposPra'	classVariableNames: ''	package: 'TrabajoPractico-1'!!EstudioAnticuerposPRA methodsFor: 'initialization' stamp: 'franklyn 11/6/2025 23:19'!initialize	super initialize.	anticuerposPra := Dictionary new.! !!EstudioAnticuerposPRA methodsFor: 'initialization' stamp: 'Franklyn 10/26/2025 20:27'!setReactividades: unDiccionario	anticuerposPra := unDiccionario.! !!EstudioAnticuerposPRA methodsFor: 'as yet unclassified' stamp: 'franklyn 11/6/2025 23:18'!getAnticuerposPra	^anticuerposPra.! !!EstudioAnticuerposPRA methodsFor: 'as yet unclassified' stamp: 'franklyn 11/6/2025 23:19'!conPRA: alelo valor: unValor	anticuerposPra at: alelo put: unValor.! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!EstudioAnticuerposPRA class	instanceVariableNames: ''!!EstudioAnticuerposPRA class methodsFor: 'as yet unclassified' stamp: 'franklyn 11/6/2025 23:19'!conReactividades: unDiccionario	^ self new setReactividades: unDiccionario; yourself! !!EstudioAnticuerposPRA class methodsFor: 'as yet unclassified' stamp: 'franklyn 11/6/2025 23:19'!new	^ super new initialize! !EstudioClinico subclass: #EstudioAptitudGeneral	instanceVariableNames: 'aptitudGeneral'	classVariableNames: ''	package: 'TrabajoPractico-1'!!EstudioAptitudGeneral methodsFor: 'as yet unclassified' stamp: 'franklyn 11/6/2025 23:15'!getAptitudGeneral	^aptitudGeneral.! !!EstudioAptitudGeneral methodsFor: 'initialization' stamp: 'franklyn 11/6/2025 23:15'!setAptitudGeneral: unaAptitudGeneral	aptitudGeneral:= unaAptitudGeneral.! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!EstudioAptitudGeneral class	instanceVariableNames: ''!!EstudioAptitudGeneral class methodsFor: 'as yet unclassified' stamp: 'franklyn 11/6/2025 23:17'!conResultado: unResultado	^ self new setAptitudGeneral: unResultado; yourself.! !EstudioClinico subclass: #EstudioCrossmatch	instanceVariableNames: 'crossmatch'	classVariableNames: ''	package: 'TrabajoPractico-1'!!EstudioCrossmatch methodsFor: 'initialization' stamp: 'franklyn 11/6/2025 23:14'!setCrossmatch: unResultado	crossmatch := unResultado.! !!EstudioCrossmatch methodsFor: 'as yet unclassified' stamp: 'franklyn 11/6/2025 23:14'!getCrossmatch	^crossmatch.! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!EstudioCrossmatch class	instanceVariableNames: ''!!EstudioCrossmatch class methodsFor: 'as yet unclassified' stamp: 'franklyn 11/6/2025 23:14'!conResultado: unResultado	^ self new setCrossmatch: unResultado; yourself.! !EstudioClinico subclass: #EstudioIMC	instanceVariableNames: ''	classVariableNames: ''	package: 'TrabajoPractico-1'!EstudioClinico subclass: #EstudioSerologicoCompleto	instanceVariableNames: 'serologicoCompleto'	classVariableNames: ''	package: 'TrabajoPractico-1'!!EstudioSerologicoCompleto methodsFor: 'initialization' stamp: 'franklyn 11/6/2025 23:17'!setSerologicoCompleto: unSerologicoCompleto	serologicoCompleto := unSerologicoCompleto! !!EstudioSerologicoCompleto methodsFor: 'as yet unclassified' stamp: 'franklyn 11/6/2025 23:17'!getSerologicoCompleto	^ serologicoCompleto.! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!EstudioSerologicoCompleto class	instanceVariableNames: ''!!EstudioSerologicoCompleto class methodsFor: 'as yet unclassified' stamp: 'franklyn 11/6/2025 23:17'!conResultado: unResultado	^ self new setSerologicoCompleto: unResultado; yourself.! !EstudioClinico subclass: #EstudioTipificacionHLA	instanceVariableNames: 'A B DR'	classVariableNames: ''	package: 'TrabajoPractico-1'!!EstudioTipificacionHLA methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/4/2025 19:47'!resultadoUnEstudioHLA: unEstudioHLA con: otroEstudioHLA	|total|	total:=0.		1 to: 2 do:[:i| 						1 to: 2 do: [ :j|												(( unEstudioHLA getA at:i)=( otroEstudioHLA getA at:j))		ifTrue:[ total:= total+1. ].												(( unEstudioHLA getB at:i)=( otroEstudioHLA getB at:j))		ifTrue:[ total:= total+1. ].												(( unEstudioHLA getDR at:i)=( otroEstudioHLA getDR at:j))	ifTrue:[ total:= total+1. ].							 ].		 ].		^total.! !!EstudioTipificacionHLA methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/4/2025 17:36'!getDR	^DR.! !!EstudioTipificacionHLA methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/4/2025 17:25'!incializarAlelosA: alelos1 B: alelos2 DR: alelos3	A := alelos1.	B := alelos2.	DR := alelos3.! !!EstudioTipificacionHLA methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/5/2025 12:33'!getTodosLosAlelos	^ ( (self getA asArray) , (self getB asArray) , (self getDR asArray) ) asOrderedCollection! !!EstudioTipificacionHLA methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/4/2025 17:36'!getA	^A.! !!EstudioTipificacionHLA methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/4/2025 17:36'!getB	^B.! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!EstudioTipificacionHLA class	instanceVariableNames: ''!!EstudioTipificacionHLA class methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 20:28'!conA: unaListaA b: unaListaB dR: unaListaDR	| nuevo |	nuevo := self new.	nuevo incializarAlelosA: unaListaA B: unaListaB DR: unaListaDR.	^nuevo.! !Object subclass: #EvaluadorCompatibilidad	instanceVariableNames: 'listaCriteriosDeseables listaCriteriosObligatorios'	classVariableNames: ''	package: 'TrabajoPractico-1'!!EvaluadorCompatibilidad methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/5/2025 10:43'!getCriteriosDeseables	^listaCriteriosDeseables ! !!EvaluadorCompatibilidad methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 20:35'!compatibilidadPaciente: unPaciente con: unDonante	| r acumulador sumaPonderaciones estudiosFaltantes |	estudiosFaltantes := OrderedCollection new.	r := ResultadoCompatibilidad new.	r setPaciente: unPaciente.	r setDonante: unDonante.	listaCriteriosObligatorios do: [ :criterio |		| faltantes |		faltantes := criterio estudiosFaltantes: unPaciente con: unDonante.		estudiosFaltantes addAll: faltantes.				faltantes isEmpty ifFalse: [ 			^r porcentajeCompatibilidad: 0.0; setEstudiosFaltantes: estudiosFaltantes		].				(criterio evaluaCompatibilidad: unPaciente con: unDonante) = #noApto ifTrue: [ 			^r porcentajeCompatibilidad: 0.0; setEstudiosFaltantes: estudiosFaltantes		].	].		acumulador := 0.0.	sumaPonderaciones := 0.0.		listaCriteriosDeseables do: [ :criterio |		| faltantes valor porcentajeParcial |		faltantes := criterio estudiosFaltantes: unPaciente con: unDonante.		estudiosFaltantes addAll: faltantes.				sumaPonderaciones := sumaPonderaciones + criterio getPonderacion.		faltantes isEmpty ifTrue: [ 			valor := criterio evaluaCompatibilidad: unPaciente con: unDonante.			porcentajeParcial := (criterio getPonderacion * valor) / 100.0.			acumulador := acumulador + porcentajeParcial.		].	].	sumaPonderaciones = 0.0 ifTrue: [ 		^r porcentajeCompatibilidad: 0.0; setEstudiosFaltantes: estudiosFaltantes	].		r setEstudiosFaltantes: estudiosFaltantes.	r porcentajeCompatibilidad: (acumulador / sumaPonderaciones) * 100.0.	^r.! !!EvaluadorCompatibilidad methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 20:34'!agregaCriterioObligatorio: unCriterioObligatorio	listaCriteriosObligatorios add: unCriterioObligatorio.! !!EvaluadorCompatibilidad methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 20:34'!agregaCriterioDeseable: unCriterioDeseable ponderacion: unNumero	unCriterioDeseable ponderacion: unNumero.	listaCriteriosDeseables add: unCriterioDeseable.! !!EvaluadorCompatibilidad methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 20:35'!inicializarEvaluadorCompatibilidad	listaCriteriosDeseables := OrderedCollection new.	listaCriteriosObligatorios := OrderedCollection new.! !!EvaluadorCompatibilidad methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 19:46'!getCriteriosObligatorios	^listaCriteriosObligatorios ! !!EvaluadorCompatibilidad methodsFor: 'initialization' stamp: 'Franklyn 10/26/2025 19:46'!setCriteriosObligatorios: unaLista	listaCriteriosObligatorios := unaLista.! !!EvaluadorCompatibilidad methodsFor: 'initialization' stamp: 'Franklyn 10/26/2025 19:46'!setCriteriosDeseables: unaLista	listaCriteriosDeseables := unaLista.! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!EvaluadorCompatibilidad class	instanceVariableNames: ''!!EvaluadorCompatibilidad class methodsFor: 'instance creation' stamp: 'Franklyn 10/26/2025 20:35'!new	|instancia|	instancia := super new.	instancia inicializarEvaluadorCompatibilidad.	^instancia.! !Object subclass: #Persona	instanceVariableNames: 'dni nombre apellido fechaNacimiento peso estatura estudios'	classVariableNames: ''	package: 'TrabajoPractico-1'!!Persona methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/5/2025 12:04'!getMesesEnListaEspera    self getFechaIngreso ifNil: [^0].    ^ ((Date today - self getFechaIngreso) days // 30) asInteger! !!Persona methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/5/2025 12:12'!getApellido	^apellido! !!Persona methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 19:52'!getEstatura	^estatura.! !!Persona methodsFor: 'as yet unclassified' stamp: 'Franklyn 9/24/2025 17:35'!getDNI	^dni.! !!Persona methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/5/2025 12:42'!getFechaNacimiento	^fechaNacimiento! !!Persona methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 19:54'!registraEstudio: unEstudioClinico	estudios add: unEstudioClinico.! !!Persona methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 19:52'!getEstudios	^estudios.! !!Persona methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/5/2025 10:00'!getNombre	^nombre.! !!Persona methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 20:23'!inicializarDNI: dato Nombre: nom Apellido: ape FechaNacimiento: fecha	self setListaEstudiosClinicos: OrderedCollection new.	self setDNI: dato.	self setNombre: nom.	self setApellido: ape.	fechaNacimiento := (fecha isKindOf: Date) ifTrue: [ fecha ] ifFalse: [ fecha asDate ].	^ self! !!Persona methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/4/2025 16:21'!peso: unPesoEnKg	peso := unPesoEnKg.! !!Persona methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/5/2025 10:08'!setpeso: unPeso	peso := unPeso.! !!Persona methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 19:52'!getPeso	^peso.! !!Persona methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 20:23'!estudioDeTipo: laClase	^ estudios detect: [ :est | est isKindOf: laClase ] ifNone: [ nil ].! !!Persona methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 19:54'!registraEstudio: unEstudioClinico con: unDonanteself registraEstudio: unEstudioClinico.unDonante registraEstudio: unEstudioClinico.! !!Persona methodsFor: 'accessing' stamp: 'Franklyn 10/26/2025 20:22'!edad	| edadX hoy |	hoy := Date today.	edadX := hoy year - fechaNacimiento year.	(hoy monthIndex < fechaNacimiento monthIndex or: [		hoy monthIndex = fechaNacimiento monthIndex and: [ hoy dayOfMonth < fechaNacimiento dayOfMonth ]	]) ifTrue: [ edadX := edadX - 1 ].	^edadX.! !!Persona methodsFor: 'accessing' stamp: 'Franklyn 10/26/2025 20:07'!estatura: unaestatura	estatura := unaestatura ! !!Persona methodsFor: 'initialization' stamp: 'Franklyn 10/5/2025 10:10'!setNombre: unNombre	nombre := unNombre.! !!Persona methodsFor: 'initialization' stamp: 'Franklyn 10/26/2025 19:55'!setListaEstudiosClinicos: unaListaDeEstudios	estudios := unaListaDeEstudios.! !!Persona methodsFor: 'initialization' stamp: 'Franklyn 10/5/2025 10:09'!setDNI: unDNI	dni:= unDNI.! !!Persona methodsFor: 'initialization' stamp: 'Franklyn 10/5/2025 12:42'!setFechaNacimiento: unaFecha	fechaNacimiento := unaFecha ! !!Persona methodsFor: 'initialization' stamp: 'Franklyn 10/5/2025 10:11'!setApellido: unApellido	apellido:= unApellido.! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!Persona class	instanceVariableNames: ''!!Persona class methodsFor: 'as yet unclassified' stamp: '10/5/2025 20:00'!conDni: dato nombre: nom apellido: ape fechaNacimiento: fecha		^ self new inicializarDNI: dato Nombre: nom Apellido: ape FechaNacimiento: fecha.! !Object subclass: #ResultadoCompatibilidad	instanceVariableNames: 'paciente donante porcentajeCompatibilidad listaEstudiosFaltantes'	classVariableNames: 'MinimoCompatibilidad'	package: 'TrabajoPractico-1'!!ResultadoCompatibilidad methodsFor: 'accessing' stamp: 'Franklyn 10/5/2025 09:57'!porcentajeCompatibilidad: unValor	self setPorcentajeCompatibilidad: unValor.! !!ResultadoCompatibilidad methodsFor: 'initialization' stamp: 'Franklyn 10/5/2025 09:56'!setPorcentajeCompatibilidad: unValor	porcentajeCompatibilidad := unValor.! !!ResultadoCompatibilidad methodsFor: 'initialization' stamp: 'Franklyn 10/5/2025 09:50'!setListaEstudiosFaltantes: unaLista	listaEstudiosFaltantes := unaLista.! !!ResultadoCompatibilidad methodsFor: 'initialization' stamp: 'Franklyn 10/5/2025 09:58'!setEstudiosFaltantes: unaColeccion	listaEstudiosFaltantes  := unaColeccion! !!ResultadoCompatibilidad methodsFor: 'initialization' stamp: 'Franklyn 10/5/2025 09:55'!setDonante: unDonante	donante := unDonante.! !!ResultadoCompatibilidad methodsFor: 'initialization' stamp: 'Franklyn 10/5/2025 09:55'!setPaciente: unPaciente	paciente := unPaciente.! !!ResultadoCompatibilidad methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/5/2025 09:56'!porcentajeCompatibilidad	^porcentajeCompatibilidad.! !!ResultadoCompatibilidad methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 20:36'!estudiosFaltantes	^listaEstudiosFaltantes ifNil:[#()].! !!ResultadoCompatibilidad methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/5/2025 09:55'!getPaciente	^paciente.! !!ResultadoCompatibilidad methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/5/2025 09:48'!inicializarResultadoCompatibilidad	listaEstudiosFaltantes := OrderedCollection new.! !!ResultadoCompatibilidad methodsFor: 'as yet unclassified' stamp: 'Franklyn 9/23/2025 10:50'!nuevoConPaciente: paciente donante: don! !!ResultadoCompatibilidad methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 20:35'!compatible	^porcentajeCompatibilidad >= self minimoCompatibilidad.! !!ResultadoCompatibilidad methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/5/2025 09:51'!setMinimoCompatibilidad: unNumero		MinimoCompatibilidad := unNumero! !!ResultadoCompatibilidad methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/5/2025 09:55'!getDonante	^donante.! !!ResultadoCompatibilidad methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/5/2025 09:57'!getEstudiosFaltantes	^listaEstudiosFaltantes ifNil:[#()].! !!ResultadoCompatibilidad methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 20:36'!minimoCompatibilidad	^ MinimoCompatibilidad ifNil: [ MinimoCompatibilidad := 50 ]! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!ResultadoCompatibilidad class	instanceVariableNames: ''!!ResultadoCompatibilidad class methodsFor: 'as yet unclassified' stamp: 'Franklyn 10/26/2025 20:37'!nuevoConPaciente: unPaciente donante: unDonante porcentajeCompatibilidad: unPorcentaje estudiosFaltantes: unaListaDeEstudios	|res|	res := self new.	res setPaciente: unPaciente.	res setDonante: unDonante.	res setPorcentajeCompatibilidad: unPorcentaje.	res setEstudiosFaltantes: unaListaDeEstudios.	^res.! !